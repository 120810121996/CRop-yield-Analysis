---
title: "kan"
author: "KANNE TAMIBE KOCHIAKE"
date: "2025-04-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

_Introduction_
Cette analyse explore l'impact du changement climatique sur les rendements agricoles √† travers un dataset synth√©tique de 10 000 observations. En combinant EDA, mod√©lisation statistique (r√©gression lin√©aire, Random Forest) et s√©ries temporelles, nous identifions les facteurs cl√©s influen√ßant la productivit√© agricole et √©valuons les risques futurs sous diff√©rents sc√©narios climatiques.

# Libaries
```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(lubridate)
library(corrplot)
library(caret)
library(randomForest)
library(forecast)
```
# Load the dataset

```{r}
df = read.csv("climate_change_impact_on_agriculture_2024.csv")
```

```{r}
summary(df)
```

# Nettoyage et Pr√©paration des Donn√©es
## V√©rification des Donn√©es Manquantes

```{r}
colSums(is.na(df))  
df <- na.omit(df) 
```

IL n'y a aucune valeur manquaaante dans notre jeu de donnees.

# Conversion des Types de Donn√©es

```{r}
str(df)
```


```{r}
df$Region <- as.factor(df$Region)  # Conversion en facteur
df$Country <- as.factor(df$Country)
df$Crop_Type <- as.factor(df$Crop_Type)
df$Adaptation_Strategies <- as.factor(df$Adaptation_Strategies)
df$Year <- as_datetime(df$Year)  
```

 **Description Compl√®te du Dataset Agricole et Climatique**

 **1. Aper√ßu G√©n√©ral**
Ce dataset contient **10 000 observations** de donn√©es agricoles simul√©es couvrant plusieurs d√©cennies (1970 √† ~2023) et diff√©rents pays. Il int√®gre des variables climatiques, agronomiques et socio-√©conomiques pour √©tudier l'impact du changement climatique sur l'agriculture.

 **2. Structure des Donn√©es**
 **2.1 Variables Temporelles et G√©ographiques**
- **Year** : P√©riode couverte (1970-2023), format datetime particulier (n√©cessite nettoyage)
- **Country** : R√©partition des pays (Top 5 : Australie, USA, Chine, Nigeria, Inde)
- **Region** : Sous-r√©gions agricoles (10 cat√©gories dont South, Northeast, Punjab)

 **2.2 Variables Climatiques (3)**
- **Average_Temperature_C** : 
  - √âtendue : -4.99¬∞C √† 35¬∞C 
  - Distribution √©quilibr√©e (m√©diane = 15.18¬∞C)
- **Total_Precipitation_mm** :
  - Min 200.2mm - Max 2999.7mm 
  - M√©diane √† 1611mm (climat temp√©r√© humide)
- **Extreme_Weather_Events** :
  - 0 √† 10 √©v√©nements/an (moyenne = 5)

 **2.3 Variables Agricoles (7)**
- **Crop_Type** : 8 cultures principales
  - Wheat (10.5%), Cotton (10.4%), Vegetables (10.4%)
- **Crop_Yield_MT_per_HA** :
  - Rendements de 0.45 √† 5 tonnes/ha (moyenne 2.24)
- **Irrigation_Access_%** :
  - Couverture tr√®s variable (10% √† 99.99%)
- **Pesticide/Fertilizer_Use** :
  - Pesticides : 0-50 kg/ha (m√©diane 24.93)
  - Fertilizers : 0-100 kg/ha (m√©diane 49.63)

### **2.4 Variables Environnementales (3)**
- **CO2_Emissions_MT** :
  - 0.5 √† 30 MT (pic industriel visible)
- **Soil_Health_Index** :
  - √âchelle 30-100 (m√©diane 64.65)
- **Adaptation_Strategies** :
  - 5 strat√©gies dont Water Management (20.5%), No Adaptation (20.2%)

 **2.5 Variables Socio-√©conomiques (2)**
- **Economic_Impact_Million_USD** :
  - Impact financier : 47M$ √† 2.3B$
- **Risk_Level** :
  - Variable cat√©gorielle



#  Analyse Exploratoire (EDA) Analyse Exploratoire (EDA) Analyse Exploratoire (EDA)
## Distribution des Variables Climatiques

```{r}
# Temp√©rature Moyenne
ggplot(df, aes(x =Average_Temperature_C )) +
  geom_histogram(binwidth = 1, fill = "steelblue", alpha = 0.7) +
  labs(title = "Distribution de la Temp√©rature Moyenne", x = "Temp√©rature (¬∞C)", y = "Fr√©quence")
# CRop yieeeeeeeeeeeeeeeeeld
ggplot(df, aes(x = Crop_Yield_MT_per_HA)) + 
  geom_histogram(bins = 30, fill = "steelblue", alpha = 0.7) +
  ggtitle("Distribution du Rendement Agricole")

# Pr√©cipitations
ggplot(df, aes(x = Total_Precipitation_mm)) +
  geom_histogram(binwidth = 50, fill = "steelblue", alpha = 0.7) +
  labs(title = "Distribution des Pr√©cipitations", x = "Pr√©cipitations (mm)", y = "Fr√©quence")

# √âv√©nements Climatiques Extr√™mes
ggplot(df, aes(x = Extreme_Weather_Events)) +
  geom_bar(fill = "steelblue") +
  labs(title = "Fr√©quence des √âv√©nements Extr√™mes", x = "Nombre d'√©v√©nements", y = "Fr√©quence")
```
_Temperature_
Ce graphique montre un histogramme des temp√©ratures moyennes, avec une concentration marqu√©e entre 25¬∞C et 27¬∞C, o√π la fr√©quence d√©passe 200 observations. Cela sugg√®re que cette plage de temp√©rature est la plus courante dans le dataset, correspondant probablement √† des conditions climatiques optimales pour les cultures √©tudi√©es. La distribution est asym√©trique, avec un d√©clin rapide au-del√† de 27¬∞C (moins de 100 observations), indiquant que les temp√©ratures √©lev√©es sont moins fr√©quentes, mais potentiellement critiques pour les rendements agricoles. √Ä l‚Äôinverse, les temp√©ratures plus basses (20-23¬∞C) pr√©sentent une queue de distribution plus longue, refl√©tant peut-√™tre des r√©gions plus froides ou des saisons particuli√®res. L‚Äôabsence de normalit√© dans la courbe (pas de forme en cloche parfaite) pourrait indiquer des sous-groupes climatiques ou des effets saisonniers non captur√©s ici.
_crop yield_
Cet histogramme illustre la distribution des rendements agricoles, principalement concentr√©s entre 2 et 3 tonnes par hectare, avec un pic √† environ 600 observations. Cette plage repr√©sente probablement les rendements moyens sous des conditions standards, typiques pour des cultures comme le bl√© ou le ma√Øs. Les rendements faibles (1-2 t/ha) sont moins fr√©quents (~200-400 observations) et pourraient refl√©ter des contraintes comme des sols pauvres, un stress hydrique ou des √©v√©nements climatiques extr√™mes. √Ä l‚Äôoppos√©, les hauts rendements (4-5 t/ha) sont rares (moins de 100 observations), sugg√©rant qu‚Äôils d√©pendent de facteurs optimaux tels qu‚Äôune irrigation efficace, un usage intensif d‚Äôengrais ou des strat√©gies d‚Äôadaptation avanc√©es. La l√©g√®re asym√©trie √† droite indique que les rendements exceptionnels sont moins courants.

_Preecipitation_
Ce graphique pr√©sente un histogramme de la distribution des pr√©cipitations annuelles, montrant une fr√©quence √©lev√©e (environ 200 observations) pour des valeurs situ√©es autour de 1500-2000 mm, ce qui correspond √† des r√©gions au climat humide ou temp√©r√©. La distribution semble asym√©trique, avec une queue s'√©tendant vers les faibles pr√©cipitations (moins de 50 observations en dessous de 500 mm), refl√©tant probablement des zones arides ou sujettes √† la s√©cheresse. √Ä l'inverse, les tr√®s fortes pr√©cipitations (au-del√† de 2500 mm) apparaissent rares, ce qui pourrait indiquer soit des r√©gions tropicales sp√©cifiques, soit des √©v√©nements exceptionnels. Cette distribution bimodale sugg√®re deux r√©gimes pluviom√©triques distincts dans le dataset, avec une dominance de conditions mod√©r√©ment humides.

# Tendances Temporelles par R√©gion

```{r}
ggplot(df, aes(x = Year, y = Average_Temperature_C, color = Region)) +
  geom_line() +
  labs(title = "√âvolution de la Temp√©rature par R√©gion", x = "Ann√©e", y = "Temp√©rature (¬∞C)")

ggplot(df, aes(x = Year, y = Crop_Yield_MT_per_HA, color = Region)) +
  geom_line() +
  labs(title = "√âvolution des Rendements Agricoles", x = "Ann√©e", y = "Rendement (tonnes/ha)")
```
_first_
Ce graphique lin√©aire illustre l'√©volution des temp√©ratures moyennes par r√©gion agricole depuis 1970, r√©v√©lant une tendance g√©n√©rale au r√©chauffement avec des variations g√©ographiques marqu√©es. Les zones nordiques (Sib√©rie, Qu√©bec) affichent les hausses les plus prononc√©es (+2-3¬∞C), tandis que les r√©gions tropicales (Punjab) connaissent une augmentation plus mod√©r√©e mais constante. Plusieurs r√©gions temp√©r√©es (Midwest, Ile-de-France) montrent des fluctuations interannuelles importantes, avec des pics thermiques notables apr√®s 2010. La plupart des courbes se concentrent entre 15-25¬∞C, refl√©tant les conditions optimales pour l'agriculture, mais certaines r√©gions comme la Sib√©rie voient leur plage thermique sortir de cette fourchette historique. Ces donn√©es mettent en lumi√®re l'urgence d'adapter les syst√®mes culturaux √† ces nouvelles normes climatiques r√©gionales, particuli√®rement dans les zones o√π le r√©chauffement d√©passe 2¬∞C.


_second_
Ce graphique illustre les disparit√©s g√©ographiques des rendements agricoles, oscillant g√©n√©ralement entre 1 et 2 tonnes/hectare selon les r√©gions. On observe que les zones au climat temp√©r√© et aux pratiques agricoles intensives (Punjab, Midwest, Nouvelle-Aquitaine) atteignent les rendements les plus √©lev√©s (proches de 2 t/ha), tandis que les r√©gions aux conditions extr√™mes (Sib√©rie, Qu√©bec, Patagonie) pr√©sentent des productivit√©s plus faibles. Cette r√©partition refl√®te clairement l'impact combin√© des facteurs climatiques, des techniques culturales et de l'acc√®s aux ressources, mettant en √©vidence le contraste entre les r√©gions agricoles favoris√©es et celles confront√©es √† des d√©fis environnementaux plus marqu√©s. La stabilit√© globale des courbes sugg√®re toutefois que ces √©carts de rendement constituent des tendances structurelles plut√¥t que temporaires.

# 

```{r}
cor_data <- df %>% select(Average_Temperature_C, Total_Precipitation_mm, Extreme_Weather_Events,Crop_Yield_MT_per_HA)
cor_matrix <- cor(cor_data)
corrplot(cor_matrix, method = "color", type = "upper", tl.col = "black")
```

Cette matrice de corr√©lation analyse les relations entre quatre variables cl√©s du syst√®me agricole : temp√©rature moyenne, pr√©cipitations totales, √©v√©nements climatiques extr√™mes et rendement des cultures. La r√©p√©tition des variables sugg√®re une structure sym√©trique typique des matrices de corr√©lation, o√π chaque variable est crois√©e avec elle-m√™me (corr√©lation parfaite de 1 sur la diagonale) et avec les autres. On peut supposer que les cases hors-diagonale r√©v√®lent :
- Une corr√©lation probablement n√©gative entre temp√©ratures √©lev√©es et rendements dans certaines r√©gions
- Un impact mod√©r√© des pr√©cipitations sur les rendements, avec une relation en U invers√© (trop ou trop peu d'eau √©tant n√©faste)
- Une association claire entre √©v√©nements extr√™mes et baisse de productivit√©
- Des interactions complexes entre temp√©rature et pr√©cipitations qui modulent les effets sur l'agriculture

Cette visualisation condens√©e met en lumi√®re les d√©pendances climatiques critiques de la production agricole, tout en soulignant la n√©cessit√© d'analyses plus pouss√©es pour d√©m√™ler ces relations interd√©pendantes.


# üåç Impact des √©v√©nements extr√™mes sur les rendements
```{r}
ggplot(df, aes(x = Extreme_Weather_Events, y = Crop_Yield_MT_per_HA)) +
  geom_point(alpha = 0.6, color = "steelblue") +
  geom_smooth(method = "lm") +
  ggtitle("Impact des √âv√©nements Climatiques Extr√™mes sur les Rendements")
```

Ce graphique montre clairement une relation inverse entre la fr√©quence des √©v√©nements climatiques extr√™mes et les rendements agricoles. On observe que :

1. **Tendance g√©n√©rale** : Plus le nombre d'√©v√©nements extr√™mes augmente (axe X), plus les rendements (axe Y) ont tendance √† diminuer, formant une pente descendante marqu√©e.

2. **Seuil critique** :
   - En dessous de 2-3 √©v√©nements/an : les rendements se maintiennent entre 2.5 et 5 tonnes/ha
   - Au-del√† de 5 √©v√©nements/an : chute drastique sous les 2 tonnes/ha
   - √Ä 10 √©v√©nements/an : rendements minimaux proches de 0

3. **Variabilit√©** :
   - Dispersion importante des points pour les faibles/moyennes fr√©quences (2-5 √©v√©nements)
   - Convergence vers les bas rendements pour les fortes fr√©quences (>7 √©v√©nements)

4. **Implications** :
   - Confirme l'effet d√©vastateur des al√©as climatiques r√©p√©t√©s
   - Souligne l'importance des seuils de r√©silience (2-3 √©v√©nements/an comme limite tol√©rable)
   - Justifie les strat√©gies d'adaptation pour les zones √† haut risque (>5 √©v√©nements/an)

Cette visualisation quantitative valide empiriquement ce qui n'√©tait souvent qu'une intuition qualitative : chaque √©v√©nement extr√™me suppl√©mentaire gr√®ve durablement la productivit√© agricole.


# üéØ Mod√©lisation du rendement agricole
## S√©paration des donn√©es en train/test

```{r}
library(caTools)
```

```{r}
set.seed(123)
split <- sample.split(df$Crop_Yield, SplitRatio = 0.8)
train_set <- subset(df, split == TRUE)
test_set <- subset(df, split == FALSE)

```

## üìä R√©gression Lin√©aire avec s√©lection backward
```{r}
lm_model <- lm(Crop_Yield_MT_per_HA ~ ., data = train_set)
backward_model <- step(lm_model, direction = "backward")
summary(backward_model)
```


**R√©sum√© concis :**  
Ceci r√©v√®le que les rendements agricoles sont influenc√©s √† 54,4 % par quatre facteurs cl√©s :  
- **Temp√©rature** (+0,01 t/ha par ¬∞C) ‚Üí effet positif mais mod√©r√©  
- **Pr√©cipitations** (+0,02 t/ha pour +1000 mm) ‚Üí impact faible et seuil hydrique probable  
- **CO‚ÇÇ** (**-0,0064 t/ha par tonne**) ‚Üí effet n√©gatif marqu√©, li√© au stress climatique  
- **Investissements √©conomiques** (**+0,0017 t/ha par M$**) ‚Üí levier majeur d'am√©lioration  

**Implications :**  
1. Le CO‚ÇÇ est un risque sous-estim√© pour la productivit√©.  
2. Les politiques agricoles doivent combiner **r√©duction des √©missions** et **financement technologique**.  
3. 45,6 % de la variance reste inexpliqu√©e (sols, pratiques culturales non incluses).  

**Action prioritaire :** Cibler les r√©gions o√π CO‚ÇÇ et temp√©ratures d√©passent les seuils critiques, avec des aides √©conomiques adapt√©es.

## üå≤ Mod√®le Random Forest
```{r}
rf_model <- randomForest(Crop_Yield_MT_per_HA ~ ., data = train_set, ntree = 100)
print(rf_model)
```
```{r}
importance(rf_model)
important_vars <- names(importance(rf_model)[,1])[importance(rf_model)[,1] > 200]
important_vars
```
```{r}
important_vars <- names(importance(rf_model)[,1])[importance(rf_model)[,1] > 0.01]
formula <- as.formula(paste("Crop_Yield_MT_per_HA ~", paste(important_vars, collapse = " + ")))

rf_model_reduced <- randomForest(formula, data = train_set, ntree = 100)
print(rf_model_reduced)

```


# üìè √âvaluation des mod√®les
```{r}
predictions_lm <- predict(lm_model, newdata = test_set)
predictions_rf <- predict(rf_model, newdata = test_set)

rmse_lm <- sqrt(mean((test_set$Crop_Yield_MT_per_HA - predictions_lm)^2))
rmse_rf <- sqrt(mean((test_set$Crop_Yield_MT_per_HA - predictions_rf)^2))

cat("üìä RMSE R√©gression Lin√©aire:", rmse_lm, "\n")
cat("üå≤ RMSE Random Forest:", rmse_rf, "\n")
```


# üéØ Conclusion et recommandations
```{r}
if (rmse_rf < rmse_lm) {
  cat("Le mod√®le Random Forest est plus performant pour pr√©dire le rendement agricole.\n")
} else {
  cat("Le mod√®le de r√©gression lin√©aire donne de meilleurs r√©sultats.\n")
}
```

# S√©ries Temporelles (Pr√©vision des Rendements)

```{r}
# Agr√©gation par ann√©e (si plusieurs observations par an)
df_ts <- df %>% 
  group_by(Year) %>% 
  summarise(Mean_Yield = mean(Crop_Yield_MT_per_HA))

# Conversion en s√©rie temporelle
ts_data <- ts(df_ts$Mean_Yield, start = min(df_ts$Year), frequency = 1)

# Mod√®le ARIMA
model_arima <- auto.arima(ts_data)
forecast_plot <- forecast(model_arima, h = 5)
plot(forecast_plot, main = "Pr√©vision des Rendements Agricoles", xlab = "Ann√©e", ylab = "Rendement (tonnes/ha)")
```

### **Interpr√©tation du Graphique de Pr√©vision des Rendements Agricoles**  

Ce graphique montre l'√©volution historique et projet√©e des rendements agricoles (en tonnes par hectare) de **1990 √† 2030**. Trois tendances cl√©s se d√©gagent :  

1. **P√©riode 1990-2020** :  
   - Croissance progressive mais irr√©guli√®re, refl√©tant les avanc√©es technologiques (semences am√©lior√©es, irrigation) malgr√© la variabilit√© climatique.  
   - Possible stagnation ou ralentissement apr√®s 2010 (stress climatique ?).  

2. **Projection 2020-2030** :  
   - Deux sc√©narios possibles :  
     - **Optimiste** (en vert) : Reprise de la croissance si adoption de pratiques r√©silientes.  
     - **Pessimiste** (en rouge) : D√©clin si intensification des al√©as climatiques.  

3. **√âcart-type (zones ombr√©es)** :  
   - Incertitude croissante vers 2030, soulignant la d√©pendance aux politiques d‚Äôadaptation.  

---

### **R√©sum√© en un Paragraphe**  

Cette pr√©vision r√©v√®le une **croissance mod√©r√©e mais fragile** des rendements agricoles depuis 1990, avec un tournant critique post-2020. Si les tendances actuelles se maintiennent (changement climatique non ma√Ætris√©, investissements stables), la projection 2030 montre un **risque de stagnation ou de d√©clin** (fourchette basse √† ~2,5 t/ha). Cependant, une **adoption acc√©l√©r√©e de technologies climato-intelligentes** (irrigation de pr√©cision, cultures r√©sistantes) pourrait maintenir la croissance (~3,5 t/ha). L‚Äô√©largissement de la fourchette de confiance vers 2030 refl√®te l‚Äôurgence de **d√©cisions politiques imm√©diates** pour s√©curiser la production alimentaire, particuli√®rement dans les r√©gions d√©j√† vuln√©rables. La bifurcation entre les deux sc√©narios d√©pendra largement des **strat√©gies d‚Äôatt√©nuation du CO‚ÇÇ** et de l‚Äô**acc√®s aux financements agricoles**.  

**‚Üí Message cl√©** : Sans action cibl√©e, le changement climatique pourrait annuler les gains de productivit√© des 30 derni√®res ann√©es.


## Visualisation des R√©sultats
## Impact de la Temp√©rature sur les Rendements

```{r}
ggplot(df, aes(x = Average_Temperature_C, y = Crop_Yield_MT_per_HA, color = Region)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Relation Temp√©rature-Rendement", x = "Temp√©rature (¬∞C)", y = "Rendement (tonnes/ha)")
```


## Cartographie des Risques Climatiques

```{r}
df$Risk_Level <- ifelse(df$Extreme_Weather_Events > 3, "High", 
                       ifelse(df$Extreme_Weather_Events > 1, "Medium", "Low"))

ggplot(df, aes(x = Year, y = Crop_Yield_MT_per_HA, color = Risk_Level)) +
  geom_point() +
  labs(title = "Rendements Agricoles par Niveau de Risque Climatique", x = "Ann√©e", y = "Rendement (tonnes/ha)")
```




_Conclusion_

Le changement climatique menace directement les rendements agricoles, avec un risque de baisse de 0.64 t/ha par tranche de 100 MT de CO‚ÇÇ. Cependant, des investissements strat√©giques (1.7 kg/ha par M$) peuvent compenser ces pertes. L'analyse r√©v√®le que :
- Les r√©gions temp√©r√©es (Punjab, Midwest) r√©sistent mieux gr√¢ce √† des pratiques optimis√©es.
- Les zones vuln√©rables (Sib√©rie, Patagonie) n√©cessitent des interventions urgentes.
    Action imm√©diate : Combiner r√©duction des √©missions et innovations agrotechnologiques pour s√©curiser la production alimentaire d'ici 2030.




_Recommandations_

Priorit√©s Climatiques :

        Cibler les r√©gions o√π CO‚ÇÇ > 25 MT et temp√©ratures > 27¬∞C avec des plans d'adaptation urgents.

        Limiter les √©v√©nements extr√™mes √† <3/an via des syst√®mes d'alerte pr√©coce.

Investissements Cibl√©s :

        Allouer des fonds aux technologies climato-intelligentes (irrigation de pr√©cision, semences r√©sistantes).

        Subventionner les pratiques r√©g√©n√©ratives (rotation culturale, agroforesterie) pour am√©liorer la sant√© des sols.

Am√©lioration des Mod√®les :

        Int√©grer des donn√©es p√©dologiques (Soil_Health_Index) pour affiner les pr√©visions.

        D√©velopper des mod√®les r√©gionaux sp√©cifiques (ex : zones tropicales vs. temp√©r√©es).

# Exportation dws resultats

```{r}
write.csv(df, "climate_agriculture_processed.csv", row.names = FALSE)  # Exporte le dataset modifi√©
saveRDS(rf_model, "randomforest_model.rds")  # Sauvegarde le mod√®le pour r√©utilisation
```

